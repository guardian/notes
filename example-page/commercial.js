define("common/modules/commercial/article-aside-adverts",["fastdom","Promise","common/utils/_","common/utils/$","common/utils/$css","common/utils/config","common/modules/commercial/create-ad-slot"],function(e,n,o,t,i,c,r){function m(m){var a,s,l,u,d=o.defaults(m||{},{columnSelector:".js-secondary-column",adSlotContainerSelector:".js-mpu-ad-slot"}),f=t(d.columnSelector),g=f.length&&"none"===i(f,"display");return c.switches.standardAdverts&&/Article|LiveBlog/.test(c.page.contentType)&&!g?(a="Article"===c.page.contentType?t(".js-content-main-column"):!1,l=t(".js-components-container",".js-secondary-column"),u=t(d.adSlotContainerSelector),new n(function(n){e.read(function(){s=!a.length||"football"!==c.page.section&&a.dim().height>=1300||"football"===c.page.section&&a.dim().height>=2200?"right-sticky":a.dim().height>=600?"right":"right-small",e.write(function(){"Article"===c.page.contentType&&"advertisement-features"===c.page.sponsorshipType&&l.addClass("u-h"),u.append(r(s,"mpu-banner-ad")),n(u)})})})):!1}return{init:m}}),define("common/modules/commercial/article-body-adverts",["fastdom","Promise","common/utils/_","common/utils/$","common/utils/config","common/utils/detect","common/modules/article/spacefinder","common/modules/commercial/create-ad-slot","common/modules/experiments/ab"],function(e,n,o,t,i,c,r,m,a){function s(){return{minAbove:c.isBreakpoint({max:"tablet"})?300:700,minBelow:300,selectors:{" > h2":{minAbove:"mobile"===c.getBreakpoint()?20:0,minBelow:250}," > *:not(p):not(h2)":{minAbove:35,minBelow:400}," .ad-slot":{minAbove:500,minBelow:500}}}}function l(){var e=o.cloneDeep(s());return e.minAbove=300,e.selectors[" > h2"].minAbove=20,e}function u(){var e=o.cloneDeep(s());return e.selectors[" .ad-slot"]={minAbove:1300,minBelow:1300},e}function d(){return r.getParaWithSpace(u()).then(function(e){return"undefined"==typeof e?n.resolve(null):(g.push(["inline"+(f.length+1),"inline"]),p(e).then(function(){return d()}))})}var f=[],g=[["inline1","inline"],["inline2","inline"]],p=function(o){if(o){var i=g[f.length],c=t.create(m(i[0],i[1]));return f.push(c),new n(function(n){e.write(function(){c.insertBefore(o),n(null)})})}return n.resolve(null)},h=function(){var e,o,t;return!i.switches.standardAdverts||"Article"!==i.page.contentType||i.page.isLiveBlog?!1:(e=s(),o=l(),i.page.hasInlineMerchandise?(g.unshift(["im","im"]),t=r.getParaWithSpace(o).then(function(e){return p(e)})):t=n.resolve(null),t.then(a.shouldRunTest("Viewability","variant")&&i.switches.commercialExtraAds?function(){return r.getParaWithSpace(e).then(function(e){return p(e)}).then(function(){return r.getParaWithSpace(e).then(function(e){return p(e)}).then(function(){return d()})})}:function(){return r.getParaWithSpace(e).then(function(e){return p(e)}).then(function(){return c.isBreakpoint({max:"tablet"})?r.getParaWithSpace(e).then(function(e){return p(e)}):n.resolve(null)})}))};return{init:h,getRules:s,getLenientRules:l,reset:function(){f=[]}}}),define("common/modules/commercial/front-commercial-components",["bonzo","common/utils/$","common/utils/config","common/modules/commercial/create-ad-slot"],function(e,n,o,t){function i(){if(!o.switches.commercialComponents||!o.page.isFront)return!1;var i,c=n.create('<div class="fc-container"></div>'),r=e(t("merchandising-high","commercial-component-high")),m=n(".fc-container");return m.length>=2?(i=0,m.length>=4&&(i="Network Front"===o.page.contentType?3:2),c.append(r).insertAfter(m[i])):void 0}return{init:i}}),define("common/modules/commercial/msie-audit",["bonzo","common/utils/$","common/utils/config","common/modules/analytics/beacon","common/utils/detect","common/utils/_"],function(e,n,o,t,i,c){function r(){return o.switches.msieAudit?void("MSIE"===i.getUserAgent.browser&&(c.once(function(){t.beaconCounts("msie-browser")})(),c.delay(function(){i.adblockInUse&&t.beaconCounts("msie-adblock")},3e3))):!1}return{init:r}}),define("common/modules/commercial/slice-adverts",["bonzo","fastdom","qwery","Promise","common/utils/$","common/utils/_","common/utils/config","common/modules/commercial/create-ad-slot","common/modules/user-prefs"],function(e,n,o,t,i,c,r,m,a){var s=["inline1","inline2","inline3"],l=function(l){if(!r.switches.standardAdverts)return!1;for(var u,d,f,g,p=c.defaults(l||{},{containerSelector:".fc-container",sliceSelector:".js-fc-slice-mpu-candidate"}),h=o(p.containerSelector),v=0,w=[],b=1,y=a.get("container-states");v<h.length;)u=h[v],d=e(u).data("id"),f=i(p.sliceSelector,u),g=c.contains(["uk","us","au"],r.page.pageId)&&0===v,!f.length||g||y&&"closed"===y[d]?v++:(w.push(f.first()),v+=b+1);return t.all(c(w).slice(0,s.length).map(function(o,c){var r=s[c],a=e(m(r,"container-inline")).addClass("ad-slot--mobile"),l=e(m(r,"container-inline")).addClass("ad-slot--not-mobile");return new t(function(e){n.write(function(){o.removeClass("fc-slice__item--no-mpu").append(l),a.insertAfter(i.ancestor(o[0],"fc-container")),e(null)})})}).valueOf()).then(function(){return w})};return{init:l}}),define("common/modules/commercial/third-party-tags/audience-science-gateway",["common/utils/config"],function(e){function n(){return e.switches.audienceScienceGateway?require(["js!//js.revsci.net/gateway/gw.js?csid=F09828&auto=t&bpid=theguardian"]):void 0}return{load:n}}),define("common/modules/commercial/third-party-tags/imr-worldwide",["common/utils/config"],function(e){function n(){if(e.switches.imrWorldwide){var n=new Image;return n.src=["//secure-uk.imrworldwide.com/cgi-bin/m?ci=uk-305078h&cg=0&cc=1&ts=compact","&si=",encodeURI(window.location.href),"&rp=",encodeURI(document.referrer),"&rnd=",(new Date).getTime()].join(""),n}}return{load:n}}),define("common/modules/commercial/third-party-tags/remarketing",["common/utils/config"],function(e){function n(){return e.switches.remarketing?require(["js!"+o],function(){window.google_trackConversion({google_conversion_id:971225648,google_custom_params:window.google_tag_params,google_remarketing_only:!0})}):void 0}var o="http://www.googleadservices.com/pagead/conversion_async.js";return{load:n}}),define("common/modules/commercial/third-party-tags/outbrain",["common/utils/$","common/utils/config","common/utils/detect"],function(e,n,o){function t(){if(n.switches.outbrain){var t={mobile:"MB_2",tablet:"MB_1",desktop:"AR_11",wide:"AR_11"};return e(".OUTBRAIN").first().attr("data-widget-id",t[o.getBreakpoint()]),require(["js!"+i])}}var i="http://widgets.outbrain.com/outbrain.js";return{load:t}}),define("common/modules/commercial/third-party-tags",["Promise","common/utils/config","common/utils/mediator","common/modules/commercial/third-party-tags/audience-science-gateway","common/modules/commercial/third-party-tags/audience-science-pql","common/modules/commercial/third-party-tags/imr-worldwide","common/modules/commercial/third-party-tags/remarketing","common/modules/commercial/third-party-tags/krux","common/modules/commercial/third-party-tags/outbrain"],function(e,n,o,t,i,c,r,m,a){function s(){if("Identity"===n.page.contentType||"identity"===n.page.section)return!1;switch(n.page.edition.toLowerCase()){case"uk":i.load(),t.load()}return n.switches.thirdPartiesLater?o.once("modules:commercial:dfp:rendered",function(){l()}):l(),e.resolve(null)}function l(){c.load(),r.load(),a.load(),m.load()}return{init:s}}),define("bootstraps/commercial",["Promise","common/utils/config","common/utils/mediator","common/utils/robust","common/utils/_","common/modules/commercial/article-aside-adverts","common/modules/commercial/article-body-adverts","common/modules/commercial/badges","common/modules/commercial/dfp","common/modules/commercial/front-commercial-components","common/modules/commercial/msie-audit","common/modules/commercial/slice-adverts","common/modules/commercial/third-party-tags","common/modules/user-prefs"],function(e,n,o,t,i,c,r,m,a,s,l,u,d,f){var g=[["cm-articleAsideAdverts",c],["cm-articleBodyAdverts",r],["cm-sliceAdverts",u],["cm-frontCommercialComponents",s],["cm-thirdPartyTags",d],["cm-badges",m]];return{init:function(){l.init();var c=[];f.isOff("adverts")||n.page.shouldHideAdverts||n.page.isSSL&&"admin"!==n.page.section||window.location.hash.match(/[#&]noads(&.*)?$/)||(i.forEach(g,function(e){t(e[0],function(){c.push(e[1].init())})}),e.all(c).then(function(){n.switches.commercial&&(t("cm-dfp",function(){a.init()}),t("cm-ready",function(){o.emit("page:commercial:ready")}))}))}}});
//# sourceMappingURL=commercial.js.map